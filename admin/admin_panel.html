<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIHOM Admin Panel</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .header h1 { font-size: 1.5rem; }
        .container { max-width: 1200px; margin: 2rem auto; padding: 0 2rem; }
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .tab {
            padding: 0.75rem 1.5rem;
            background: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .tab:hover { background: #3498db; color: white; }
        .tab.active { background: #3498db; color: white; }
        .content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .section { display: none; }
        .section.active { display: block; }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #555;
        }
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.95rem;
            font-family: inherit;
        }
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        .btn {
            padding: 0.75rem 2rem;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background 0.3s;
        }
        .btn:hover { background: #229954; }
        .btn-secondary {
            background: #95a5a6;
        }
        .btn-secondary:hover { background: #7f8c8d; }
        .btn-danger {
            background: #e74c3c;
        }
        .btn-danger:hover { background: #c0392b; }
        .alert {
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 6px;
            display: none;
        }
        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .card {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid #3498db;
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }
        .loading {
            text-align: center;
            padding: 2rem;
            color: #7f8c8d;
        }
        .image-preview {
            max-width: 200px;
            margin-top: 0.5rem;
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>NIHOM Admin Panel</h1>
    </div>

    <div class="container">
        <div class="tabs">
            <button class="tab active" onclick="showTab('hero')">Hero Section</button>
            <button class="tab" onclick="showTab('about')">About Us</button>
            <button class="tab" onclick="showTab('mission')">Mission & Vision</button>
            <button class="tab" onclick="showTab('courses')">Courses</button>
            <button class="tab" onclick="showTab('gallery')">Gallery</button>
            <button class="tab" onclick="showTab('contact')">Contact Info</button>
        </div>

        <div class="content">
            <div id="alert" class="alert"></div>

            <!-- Hero Section -->
            <div id="hero" class="section active">
                <h2>Hero Section Content</h2>
                <form id="heroForm" onsubmit="updateHero(event)">
                    <div class="form-group">
                        <label>Badge Text</label>
                        <input type="text" name="badge_text" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Title Line 1</label>
                            <input type="text" name="title_line1" required>
                        </div>
                        <div class="form-group">
                            <label>Title Line 2</label>
                            <input type="text" name="title_line2" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Subtitle Word 1</label>
                            <input type="text" name="subtitle_word1" required>
                        </div>
                        <div class="form-group">
                            <label>Subtitle Word 2</label>
                            <input type="text" name="subtitle_word2" required>
                        </div>
                        <div class="form-group">
                            <label>Subtitle Word 3</label>
                            <input type="text" name="subtitle_word3" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea name="description" required></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Students Count</label>
                            <input type="number" name="stat_students" required>
                        </div>
                        <div class="form-group">
                            <label>Programs Count</label>
                            <input type="number" name="stat_programs" required>
                        </div>
                        <div class="form-group">
                            <label>Faculty Count</label>
                            <input type="number" name="stat_faculty" required>
                        </div>
                    </div>
                    <button type="submit" class="btn">Save Changes</button>
                </form>
            </div>

            <!-- About Section -->
            <div id="about" class="section">
                <h2>About Us Content</h2>
                <form id="aboutForm" onsubmit="updateAbout(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Section Tag</label>
                            <input type="text" name="section_tag" required>
                        </div>
                        <div class="form-group">
                            <label>Section Title</label>
                            <input type="text" name="section_title" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Lead Text</label>
                        <textarea name="lead_text" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Paragraph 1</label>
                        <textarea name="paragraph1" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Paragraph 2</label>
                        <textarea name="paragraph2" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Paragraph 3</label>
                        <textarea name="paragraph3" required></textarea>
                    </div>
                    <button type="submit" class="btn">Save Changes</button>
                </form>
            </div>

            <!-- Mission & Vision Section -->
            <div id="mission" class="section">
                <h2>Mission & Vision</h2>
                <form id="missionForm" onsubmit="updateMissionVision(event)">
                    <div class="form-group">
                        <label>Mission Statement</label>
                        <textarea name="mission_text" required rows="6"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Vision Statement</label>
                        <textarea name="vision_text" required rows="6"></textarea>
                    </div>
                    <button type="submit" class="btn">Save Changes</button>
                </form>
            </div>

            <!-- Courses Section -->
            <div id="courses" class="section">
                <h2>Courses Management</h2>
                <div id="coursesList" class="loading">Loading courses...</div>
            </div>

            <!-- Gallery Section -->
            <div id="gallery" class="section">
                <h2>Gallery Management</h2>
                <button class="btn" onclick="showAddImageForm()" style="margin-bottom: 1rem;">Add New Image</button>
                <div id="addImageForm" style="display:none; margin-bottom: 2rem;">
                    <div class="card">
                        <h3>Add New Gallery Image</h3>
                        <form id="newImageForm" onsubmit="addGalleryImage(event)">
                            <div class="form-group">
                                <label>Image URL (or upload below)</label>
                                <input type="text" name="image_url" required>
                            </div>
                            <div class="form-group">
                                <label>Alt Text</label>
                                <input type="text" name="alt_text" required>
                            </div>
                            <div class="form-group">
                                <label>Caption (optional)</label>
                                <input type="text" name="caption">
                            </div>
                            <div class="form-group">
                                <label>Display Order</label>
                                <input type="number" name="display_order" value="0">
                            </div>
                            <button type="submit" class="btn">Add Image</button>
                            <button type="button" class="btn btn-secondary" onclick="hideAddImageForm()">Cancel</button>
                        </form>
                    </div>
                </div>
                <div id="galleryList" class="loading">Loading gallery...</div>
            </div>

            <!-- Contact Section -->
            <div id="contact" class="section">
                <h2>Contact Information</h2>
                <form id="contactForm" onsubmit="updateContact(event)">
                    <div class="form-group">
                        <label>Location</label>
                        <textarea name="location" required rows="3"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label>Phone</label>
                            <input type="text" name="phone" required>
                        </div>
                    </div>
                    <button type="submit" class="btn">Save Changes</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '';

        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');

            // Load data for specific tabs
            if (tabName === 'courses') loadCourses();
            if (tabName === 'gallery') loadGallery();
        }

        // Alert functions
        function showAlert(message, type = 'success') {
            const alert = document.getElementById('alert');
            alert.textContent = message;
            alert.className = `alert ${type}`;
            alert.style.display = 'block';
            setTimeout(() => alert.style.display = 'none', 5000);
        }

        // Load data on page load
        async function loadHero() {
            const res = await fetch(`${API_BASE}/api/hero`);
            const data = await res.json();
            const form = document.getElementById('heroForm');
            Object.keys(data).forEach(key => {
                const input = form.querySelector(`[name="${key}"]`);
                if (input) input.value = data[key] || '';
            });
        }

        async function loadAbout() {
            const res = await fetch(`${API_BASE}/api/about`);
            const data = await res.json();
            const form = document.getElementById('aboutForm');
            Object.keys(data).forEach(key => {
                const input = form.querySelector(`[name="${key}"]`);
                if (input) input.value = data[key] || '';
            });
        }

        async function loadMissionVision() {
            const res = await fetch(`${API_BASE}/api/mission-vision`);
            const data = await res.json();
            const form = document.getElementById('missionForm');
            Object.keys(data).forEach(key => {
                const input = form.querySelector(`[name="${key}"]`);
                if (input) input.value = data[key] || '';
            });
        }

        async function loadContact() {
            const res = await fetch(`${API_BASE}/api/contact`);
            const data = await res.json();
            const form = document.getElementById('contactForm');
            Object.keys(data).forEach(key => {
                const input = form.querySelector(`[name="${key}"]`);
                if (input) input.value = data[key] || '';
            });
        }

        async function loadCourses() {
            const res = await fetch(`${API_BASE}/api/courses`);
            const courses = await res.json();
            const container = document.getElementById('coursesList');
            container.innerHTML = courses.map(course => `
                <div class="card">
                    <form onsubmit="updateCourse(event, ${course.id})">
                        <div class="card-header">
                            <div class="card-title">${course.title}</div>
                        </div>
                        <div class="form-group">
                            <label>Title</label>
                            <input type="text" name="title" value="${course.title}" required>
                        </div>
                        <div class="form-group">
                            <label>Short Description</label>
                            <textarea name="short_description" required>${course.short_description}</textarea>
                        </div>
                        <div class="form-group">
                            <label>Image URL</label>
                            <input type="text" name="image_url" value="${course.image_url}" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Display Order</label>
                                <input type="number" name="display_order" value="${course.display_order}">
                            </div>
                            <div class="form-group">
                                <label>Active</label>
                                <select name="is_active">
                                    <option value="true" ${course.is_active ? 'selected' : ''}>Yes</option>
                                    <option value="false" ${!course.is_active ? 'selected' : ''}>No</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn">Update Course</button>
                    </form>
                </div>
            `).join('');
        }

        async function loadGallery() {
            const res = await fetch(`${API_BASE}/api/gallery`);
            const images = await res.json();
            const container = document.getElementById('galleryList');
            container.innerHTML = `<div class="grid">` + images.map(img => `
                <div class="card">
                    <img src="${API_BASE}/static/${img.image_url}" class="image-preview" style="max-width:100%;">
                    <form onsubmit="updateGalleryImage(event, ${img.id})">
                        <div class="form-group">
                            <label>Image URL</label>
                            <input type="text" name="image_url" value="${img.image_url}" required>
                        </div>
                        <div class="form-group">
                            <label>Alt Text</label>
                            <input type="text" name="alt_text" value="${img.alt_text}" required>
                        </div>
                        <div class="form-group">
                            <label>Caption</label>
                            <input type="text" name="caption" value="${img.caption || ''}">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Order</label>
                                <input type="number" name="display_order" value="${img.display_order}">
                            </div>
                            <div class="form-group">
                                <label>Active</label>
                                <select name="is_active">
                                    <option value="true" ${img.is_active ? 'selected' : ''}>Yes</option>
                                    <option value="false" ${!img.is_active ? 'selected' : ''}>No</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn">Update</button>
                        <button type="button" class="btn btn-danger" onclick="deleteGalleryImage(${img.id})">Delete</button>
                    </form>
                </div>
            `).join('') + `</div>`;
        }

        // Update functions
        async function updateHero(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const res = await fetch(`${API_BASE}/api/hero`, { method: 'PUT', body: formData });
            const data = await res.json();
            showAlert(data.message);
        }

        async function updateAbout(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const res = await fetch(`${API_BASE}/api/about`, { method: 'PUT', body: formData });
            const data = await res.json();
            showAlert(data.message);
        }

        async function updateMissionVision(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const res = await fetch(`${API_BASE}/api/mission-vision`, { method: 'PUT', body: formData });
            const data = await res.json();
            showAlert(data.message);
        }

        async function updateContact(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const res = await fetch(`${API_BASE}/api/contact`, { method: 'PUT', body: formData });
            const data = await res.json();
            showAlert(data.message);
        }

        async function updateCourse(e, courseId) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const res = await fetch(`${API_BASE}/api/courses/${courseId}`, { method: 'PUT', body: formData });
            const data = await res.json();
            showAlert(data.message);
        }

        async function updateGalleryImage(e, imageId) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const res = await fetch(`${API_BASE}/api/gallery/${imageId}`, { method: 'PUT', body: formData });
            const data = await res.json();
            showAlert(data.message);
            loadGallery();
        }

        async function deleteGalleryImage(imageId) {
            if (!confirm('Are you sure you want to delete this image?')) return;
            const res = await fetch(`${API_BASE}/api/gallery/${imageId}`, { method: 'DELETE' });
            const data = await res.json();
            showAlert(data.message);
            loadGallery();
        }

        async function addGalleryImage(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const res = await fetch(`${API_BASE}/api/gallery`, { method: 'POST', body: formData });
            const data = await res.json();
            showAlert(data.message);
            hideAddImageForm();
            loadGallery();
        }

        function showAddImageForm() {
            document.getElementById('addImageForm').style.display = 'block';
        }

        function hideAddImageForm() {
            document.getElementById('addImageForm').style.display = 'none';
            document.getElementById('newImageForm').reset();
        }

        // Load initial data
        window.addEventListener('load', () => {
            loadHero();
            loadAbout();
            loadMissionVision();
            loadContact();
        });
    </script>
</body>
</html>
